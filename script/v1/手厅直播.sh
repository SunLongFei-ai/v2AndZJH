





#       vmess 一键转换为 脚本模式
#           Daniel                     
#    (使用方法:在等号后面加上自己的节点)
#              |  | 
#              |  | 
#              |  |
#             / /
#            / /
#           / /
#           V

Vmess=vmess://eyJhZGQiOiI1NC4xODAuODYuMjQzIiwiYWlkIjoiNjQiLCJob3N0IjoiYS4xODkuY24iLCJpZCI6IjljZDkwMjllLWU1MTctNDc1MC04M2E0LWU0NzkxOTQ3YjI1ZSIsIm5ldCI6InRjcCIsInBhdGgiOiIvIiwicG9ydCI6IjgwIiwicHMiOiJtbCIsInRscyI6IiIsInR5cGUiOiJodHRwIiwidiI6IjIifQ==


#自定义节点名称

v2name=ml














































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































                                
                                                                                                                                                                              
                                                                                                       zt=`sed -n 24p ./一键转换vmess并使用.sh`
                                                                                                       echo $zt >./输出1.ini
                                                                                                       name=`cut -d '=' -f 2 ./输出1.ini`
                                                                                                       echo $Vmess >./输出.ini
                                                                                                       v2=`cut -d '/' -f 3 ./输出.ini`
                                                                                                       test=$(printf "%s" $v2| base64 -d)
                                                                                                       echo "$test" > ./输出.ini
                                                                                                       ip=`cut -d '"' -f 4 ./输出.ini` #ip
                                                                                                       port=`cut -d '"' -f 28 ./输出.ini` #接口
                                                                                                       uuid=`cut -d '"' -f 16 ./输出.ini` #uuid
                                                                                                       alterld=`cut -d '"' -f 8 ./输出.ini` #额外id
                                                                                                       network=`cut -d '"' -f 20 ./输出.ini` #传输协议
                                                                                                       path=`cut -d '"' -f 24 ./输出.ini` #path
                                                                                                       tsoh=`cut -d '"' -f 12 ./输出.ini` #tsoh
host=pull.free.video.10010.com
                                                                                                       if [[ "tcp" == ${network} ]]; then
                                                                                                       network=GET
                                                                                                       fi                                                                                                       
                                                                                                       
                                                                                                       echo -e "addr="$ip:$port"\nuuid="$uuid"\nalterId=$alterld\nsecurity="auto"\nmethod="$network"\npath="$path"\nhost="$host"\nDNS="223.6.6.6"" >./config/$name.ini   
                                                                                                       sed -i "/file=/cfile=$name" ./config.ini    
                                                                                                       choose='cd /data/v2/\nproject_name="${0##*/}"\nname=`echo $project_name`\nfilename="${name%.*}"\nsed -i "/file=/cfile=$filename" config.ini\necho -e "\n- 节点成功更换"'
                                                                                                       echo -e "$choose">./节点选择/$name.sh
o=Vmess=
sed -i "18c${o}" ./一键转换vmess并使用.sh
rm -f ./*.bak
rm -f ./输出.ini
rm -f ./输出1.ini
#
${0%/*}/*/"xtun".bin start
zjlPath="${0%/*}/*/ZJL"

if [[ `echo "${zjlPath}" | grep ' '` ]]; then
    isNormal="containsSpaces"
elif [ -f ${zjlPath} ]; then
    [ -x ${zjlPath} ] || isNormal="permissionDenied"
else
    isNormal="notFound"
fi

if [[ ! ${isNormal} ]]; then
    ${zjlPath} -d
else
    echo "\n      __________________________\n\n"\
          "              ZJL 2.0\n"\
          "     __________________________\n"
          
    if [[ "containsSpaces" == ${isNormal} ]]; then
        echo "           脚本路径存在空格\n\n"\
              "          请重命名后再使用"
    elif [[ "notFound" == ${isNormal} ]]; then
        echo "           找不到ZJL核心文件\n\n"\
              "          请复制回模块文件夹\n\n"\
              "          请修改权限为0777"
    else
        echo "           ZJL核心权限有问题\n\n"\
              "          请修改权限为0777"
    fi
    echo "     __________________________\n"
fi